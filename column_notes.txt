Общее количество уроков = количество строк с пользователем в lesson_stats без дубликатов :)
Количество законченных уроков = уроки, где есть оценка за тест
Текущий урок = самый поздний по времени начатый урок. Если равен нулю, значит пользователь не открывал новых уроков, после того, как закончил один из.
Время на курсе (завершённые уроки) = сумма длительностей завершённых уроков
Время на курсе (max-min) = самое позднее время на платформе - самое раннее время на платформе

Модуль - считаем начало урока с "Дата открытия модуля"
Прослушивание - считаем начало урока с "Дата начала прослушивания"

Всё время указано в секундах.